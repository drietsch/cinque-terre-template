---
import Layout from '../layouts/Layout.astro';
import Footer from '../components/Footer';
import EditorialHero from '../components/EditorialHero.astro';
import EditorialIntro from '../components/EditorialIntro.astro';
import EditorialInterlude from '../components/EditorialInterlude.astro';
import EditorNote from '../components/EditorNote.astro';
import PracticalInfoItem from '../components/PracticalInfoItem.astro';
import ReviewSummary from '../components/ReviewSummary.astro';
import SectionHeader from '../components/SectionHeader.astro';
import ClosingNote from '../components/ClosingNote.astro';
import { Star, MapPin, Clock, Utensils, Wine, Info, Compass, Waves, Sun, Heart } from 'lucide-react';

const restaurants = [
    // ... (keep the restaurants array as is)
];
---

<Layout title="The Culinary Story of Riomaggiore | Cinque Terre Dispatch">
    <EditorialHero 
        title="The Story of<br/>the Table"
        subtitle="In Riomaggiore, food is not an attraction. It is a rhythm, a memory, and a response to a vertical world."
        badge="Culinary Narrative"
        image="https://images.unsplash.com/photo-1499678329028-101435549a4e?q=80&w=2670&auto=format&fit=crop"
    />

    <EditorialIntro 
        badge="The Culinary Story"
        quote="To eat in Riomaggiore is to understand scarcity. For centuries, this village had no flat land for cattle, no wide fields for grain. It had only the verticality of the cliffs and the depth of the sea."
    >
        <div class="space-y-6">
            <p>
                The story begins in the <strong>terraces</strong>. Every inch of soil was earned, carved out of the rock to plant grapevines and olive trees. This is why wine here is not just a drink; it is the village's primary currency of labor. The Sciacchetrà you sip today is the same liquid gold that has sustained these families through generations of isolation.
            </p>
            <p>
                Then there is the <strong>sea</strong>. Because the village was poor and the work was hard, the food became simple. Fish is served with little more than a squeeze of lemon and a drizzle of the oil pressed from those hillside groves. There is no need for heavy sauces when the catch was in the water three hours ago.
            </p>
        </div>
        <div class="space-y-6">
            <p>
                You will notice that <strong>menus are short</strong>. This is not a lack of choice, but a commitment to the day. If the sea was rough, there is no sea bass. If the 'orto' (the garden) is between seasons, the vegetables will change. We eat what the land and sea allow, following a rhythm tied to light and weather.
            </p>
            <p>
                Meals here follow the <strong>rhythm of work</strong>. A quick cone of fried fish at midday to keep moving, and a long, slow dinner as the sun dips behind the village—a time to reclaim the day from the crowds. To eat well here is to be receptive to these rhythms, to stop looking for variety and start looking for place.
            </p>
        </div>
    </EditorialIntro>

    <!-- Transition Section -->
    <section class="py-20 bg-secondary/20 border-y border-border/40">
        <div class="container mx-auto px-4 text-center">
            <h2 class="font-serif text-4xl md:text-5xl font-bold text-foreground mb-6">
                Where this story is still cooked
            </h2>
            <p class="text-xl text-muted-foreground max-w-2xl mx-auto font-light leading-relaxed">
                The following places are not a leaderboard. They are a collection of different facets of our culinary culture—each one a portrait of how Riomaggiore feeds itself and its guests.
            </p>
        </div>
    </section>

    <!-- Restaurants Collection -->
    <section class="py-24 container mx-auto px-4">
        <div class="space-y-32">
            {restaurants.map((restaurant, index) => (
                <div class="space-y-16">
                    {/* Editorial Interludes */}
                    {index === 3 && (
                        <EditorialInterlude 
                            title="The Logic of the Short Menu"
                            quote="In many places, a long menu is a sign of abundance. In Riomaggiore, it is often a sign of frozen storage. Look for the places that offer only four or five starters and mains. It means the chef was at the harbor this morning, and the 'orto' yesterday. Variety is the enemy of freshness in a village this small."
                            type="primary"
                            align="left"
                        >
                            <Utensils slot="icon" className="w-96 h-96" />
                        </EditorialInterlude>
                    )}

                    {index === 6 && (
                        <EditorialInterlude 
                            title="The Bread and the Oil"
                            quote="Before you order, look at the bread and the oil on the table. In Liguria, these are not fillers. The oil should be green-gold and smell of the hills. The bread should be simple, a vessel for that oil. If a restaurant gets these two right, you can trust them with the rest of the meal."
                            type="secondary"
                            align="right"
                        >
                            <Wine slot="icon" className="w-96 h-96" />
                        </EditorialInterlude>
                    )}

                    <article class="group cursor-pointer">
                        <!-- Image -->
                        <div class="relative aspect-[21/9] overflow-hidden rounded-xl mb-8">
                            <img 
                                src={restaurant.image} 
                                alt={restaurant.name}
                                class="object-cover w-full h-full transition-transform duration-500 group-hover:scale-105"
                            />
                            <span class="absolute top-6 left-6 bg-white/90 text-black px-3 py-1.5 rounded-full text-xs font-semibold uppercase tracking-wide shadow-sm">
                                {restaurant.category}
                            </span>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
                            
                            {/* Main Content (2/3) */}
                            <div class="lg:col-span-2 space-y-8">
                                <!-- Header -->
                                <div>
                                    <div class="flex items-center gap-2 mb-3">
                                        <MapPin className="w-4 h-4 text-primary" />
                                        <span class="text-sm font-medium text-muted-foreground">{restaurant.village}</span>
                                    </div>
                                    <h2 class="font-serif text-4xl md:text-5xl font-bold mb-4 group-hover:text-primary transition-colors leading-tight">
                                        {restaurant.name}
                                    </h2>
                                </div>

                                {/* Signature Quote (Intro) */}
                                <div class="pl-6 border-l-2 border-primary/30">
                                    <p class="font-serif text-xl italic text-foreground/70 leading-relaxed">
                                        "{restaurant.intro}"
                                    </p>
                                </div>

                                {/* Description */}
                                <div class="prose prose-lg max-w-none">
                                    <p class="text-foreground/80 text-lg leading-relaxed mb-4">
                                        {restaurant.description}
                                    </p>
                                    <p class="text-muted-foreground leading-relaxed flex items-center gap-2">
                                        <Heart className="w-4 h-4 text-primary/60" />
                                        {restaurant.signature}
                                    </p>
                                </div>

                                <EditorNote quote={restaurant.giuliaComment} />
                            </div>

                            {/* Facts Sidebar (1/3) */}
                            <div class="lg:col-span-1">
                                <div class="sticky top-24 space-y-10">
                                    <!-- Header -->
                                    <div>
                                        <h3 class="font-serif text-2xl font-bold text-foreground mb-6 pb-4 border-b border-border">
                                            Essential Information
                                        </h3>
                                        
                                        <!-- Map Integration -->
                                        <div class="relative aspect-video rounded-xl overflow-hidden border border-border/50 mb-8 group/map">
                                            <img 
                                                src="https://api.mapbox.com/styles/v1/mapbox/light-v11/static/pin-l+bf2b2b(9.7376,44.099)/9.7386,44.0994,15.39,0/640x360@2x?before_layer=admin-1-boundary&access_token=pk.eyJ1IjoiZHJpZXRzY2giLCJhIjoiY21qYjAzMWxtMGJpZDNlc2RqMWN3NHdjbSJ9.k9Xvn4saiEtYhrJE8bKk7Q" 
                                                alt="Location Map"
                                                class="object-cover w-full h-full transition-transform duration-700 group-hover/map:scale-110"
                                            />
                                            <div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover/map:opacity-100 transition-opacity"></div>
                                        </div>
                                    </div>
                                    
                                    <ReviewSummary 
                                        googleRating={restaurant.googleRating} 
                                        tripadvisorRating={restaurant.tripadvisorRating} 
                                    />

                                    <!-- Info Items -->
                                    <div class="space-y-8">
                                        <SectionHeader label="Practical Details" />

                                        <div class="space-y-6">
                                            <PracticalInfoItem label="Price Range" value={restaurant.category}>
                                                <span slot="icon" class="text-primary font-bold text-lg">{restaurant.cost}</span>
                                            </PracticalInfoItem>

                                            <PracticalInfoItem label="Opening Hours" value={restaurant.openingTimes}>
                                                <Clock slot="icon" className="w-5 h-5 text-primary" />
                                            </PracticalInfoItem>
                                            
                                            <PracticalInfoItem label="Notes" value={restaurant.practicalInfo}>
                                                <Info slot="icon" className="w-5 h-5 text-primary" />
                                            </PracticalInfoItem>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </article>
                </div>
            ))}
        </div>
    </section>

    <ClosingNote title="The Best Meal is a Matter of Mood">
        <Waves slot="background" className="w-full h-full scale-150" />
        <p>
            In the end, eating well in Riomaggiore is less about finding the "perfect" restaurant and more about matching your meal to your spirit. 
        </p>
        <p>
            Some days require the quiet of a hidden osteria; others, the salt-spray energy of the harbor rocks with a paper cone of fish. Sometimes, all you need is a glass of Sciacchetrà and the sound of the sea.
        </p>
        <p>
            Slow down. Notice the light. Listen to the village. The table will find you.
        </p>
        <div slot="actions" class="flex flex-wrap justify-center gap-6">
            <a href="/itinerary" class="px-8 py-4 rounded-full bg-primary text-white font-bold text-sm uppercase tracking-widest hover:bg-primary/90 transition-colors">
                Plan Your Day
            </a>
            <a href="/village" class="px-8 py-4 rounded-full bg-white/10 backdrop-blur-sm text-white font-bold text-sm uppercase tracking-widest hover:bg-white/20 transition-colors">
                Explore the Village
            </a>
        </div>
    </ClosingNote>

    <Footer />
</Layout>

<style>
    html {
        scroll-behavior: smooth;
    }

    .font-serif {
        letter-spacing: -0.02em;
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    article {
        animation: fadeInUp 0.8s ease-out;
        animation-fill-mode: both;
    }
</style>
