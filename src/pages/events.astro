---
import Layout from '../layouts/Layout.astro';
import Footer from '../components/Footer';
import EditorialHero from '../components/EditorialHero.astro';
import EditorialIntro from '../components/EditorialIntro.astro';
import EditorialInterlude from '../components/EditorialInterlude.astro';
import EditorNote from '../components/EditorNote.astro';
import PracticalInfoItem from '../components/PracticalInfoItem.astro';
import ReviewSummary from '../components/ReviewSummary.astro';
import SectionHeader from '../components/SectionHeader.astro';
import ClosingNote from '../components/ClosingNote.astro';
import { Star, MapPin, Clock, Calendar, Users, Info, Compass, Waves, Sun, Heart, Music, Anchor } from 'lucide-react';

const events = [
    // ... (keep the events array as is)
];
---

<Layout title="Events & Rhythms of Riomaggiore | Cinque Terre Dispatch">
    <EditorialHero 
        title="Moments of<br/>Shared Attention"
        subtitle="Events in Riomaggiore are not spectacles. They are the brief surfacing of a deep, local rhythm—moments when the village remembers who it is."
        badge="The Living Calendar"
        image="https://images.unsplash.com/photo-1498503182468-3b51cbb6cb24?q=80&w=2670&auto=format&fit=crop"
    />

    <EditorialIntro 
        badge="The Meaning of Gathering"
        quote="To understand an event in Riomaggiore, you must first understand that it is not for you. It is for the village, for the ancestors, and for the sea."
    >
        <div class="space-y-6">
            <p>
                Most of our gatherings are <strong>rooted in the soil and the sea</strong>. They follow the religious calendar, the cycles of the vineyards, or the ancient traditions of the fishing boats. They are repetitive, familiar, and deeply personal. We do not celebrate to entertain, but to participate in a continuity that stretches back centuries.
            </p>
            <p>
                You will find that <strong>spectacle is rare</strong>. The beauty of a procession or a harvest is found in its lack of polish—in the way a neighbor carries a heavy statue, or the way the smell of fermenting grapes fills the streets. These are moments of shared attention, where the village briefly reorganizes itself around a common purpose.
            </p>
        </div>
        <div class="space-y-6">
            <p>
                The meaning of these events lies in <strong>observation and respect</strong>. We invite you to watch, to listen, and to feel the shift in the village's energy. But we ask that you do so from the edge, with the understanding that you are witnessing a private moment of community. There is no need for applause; your presence is enough.
            </p>
            <p>
                In Riomaggiore, <strong>timing is everything</strong>. Some events last all day, others only a few luminous minutes. Some are loud and colorful, others are silent and dark. To be present for these moments is to see the village reveal itself differently, showing a face that is usually kept hidden from the midday sun.
            </p>
        </div>
    </EditorialIntro>

    <!-- Transition Section -->
    <section class="py-20 bg-secondary/20 border-y border-border/40">
        <div class="container mx-auto px-4 text-center">
            <h2 class="font-serif text-4xl md:text-5xl font-bold text-foreground mb-6">
                When the village gathers
            </h2>
            <p class="text-xl text-muted-foreground max-w-2xl mx-auto font-light leading-relaxed">
                The following portraits follow the natural flow of the year. They are not a schedule to be chased, but a story to be understood.
            </p>
        </div>
    </section>

    <!-- Events Collection -->
    <section class="py-24 container mx-auto px-4">
        <div class="space-y-32">
            {events.map((event, index) => (
                <div class="space-y-16">
                    {/* Editorial Interludes */}
                    {index === 2 && (
                        <EditorialInterlude 
                            title="The Art of the Edge"
                            quote="The best way to experience a village event is from the edge. Don't try to be at the front of the procession or the center of the square. Find a high step, a quiet corner, or a window. From the periphery, you see the whole—the way the light hits the faces of the elders, the way the children mimic the movements of their parents. You are a witness, not a participant, and there is great beauty in that distance."
                            type="primary"
                            align="left"
                        >
                            <Anchor slot="icon" className="w-96 h-96" />
                        </EditorialInterlude>
                    )}

                    {index === 4 && (
                        <EditorialInterlude 
                            title="Silence and Noise"
                            quote="Riomaggiore lives in the alternation of silence and noise. Our events are often loud—bells, singing, fireworks—but they are always followed by a deeper silence. This contrast is what gives the celebration its weight. After the fireworks of San Giovanni, the harbor feels more still than it does on any other night. The noise is a necessary release, but the silence is where the meaning settles."
                            type="secondary"
                            align="right"
                        >
                            <Music slot="icon" className="w-96 h-96" />
                        </EditorialInterlude>
                    )}

                    <article class="group cursor-pointer">
                        <!-- Image -->
                        <div class="relative aspect-[21/9] overflow-hidden rounded-xl mb-8">
                            <img 
                                src={event.image} 
                                alt={event.name}
                                class="object-cover w-full h-full transition-transform duration-500 group-hover:scale-105"
                            />
                            <span class="absolute top-6 left-6 bg-white/90 text-black px-3 py-1.5 rounded-full text-xs font-semibold uppercase tracking-wide shadow-sm">
                                {event.category}
                            </span>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-12">
                            
                            {/* Main Content (2/3) */}
                            <div class="lg:col-span-2 space-y-8">
                                <!-- Header -->
                                <div>
                                    <div class="flex items-center gap-2 mb-3">
                                        <Calendar className="w-4 h-4 text-primary" />
                                        <span class="text-sm font-medium text-muted-foreground">{event.date}</span>
                                    </div>
                                    <h2 class="font-serif text-4xl md:text-5xl font-bold mb-4 group-hover:text-primary transition-colors leading-tight">
                                        {event.name}
                                    </h2>
                                </div>

                                {/* Signature Quote (Intro) */}
                                <div class="pl-6 border-l-2 border-primary/30">
                                    <p class="font-serif text-xl italic text-foreground/70 leading-relaxed">
                                        "{event.intro}"
                                    </p>
                                </div>

                                {/* Description */}
                                <div class="prose prose-lg max-w-none">
                                    <p class="text-foreground/80 text-lg leading-relaxed mb-4">
                                        {event.description}
                                    </p>
                                    <p class="text-muted-foreground leading-relaxed flex items-center gap-2">
                                        <Heart className="w-4 h-4 text-primary/60" />
                                        {event.signature}
                                    </p>
                                </div>

                                <EditorNote quote={event.giuliaComment} />
                            </div>

                            {/* Facts Sidebar (1/3) */}
                            <div class="lg:col-span-1">
                                <div class="sticky top-24 space-y-10">
                                    <!-- Header -->
                                    <div>
                                        <h3 class="font-serif text-2xl font-bold text-foreground mb-6 pb-4 border-b border-border">
                                            Essential Information
                                        </h3>
                                        
                                        <!-- Map Integration -->
                                        <div class="relative aspect-video rounded-xl overflow-hidden border border-border/50 mb-8 group/map">
                                            <img 
                                                src="https://api.mapbox.com/styles/v1/mapbox/light-v11/static/pin-l+bf2b2b(9.7376,44.099)/9.7386,44.0994,15.39,0/640x360@2x?before_layer=admin-1-boundary&access_token=pk.eyJ1IjoiZHJpZXRzY2giLCJhIjoiY21qYjAzMWxtMGJpZDNlc2RqMWN3NHdjbSJ9.k9Xvn4saiEtYhrJE8bKk7Q" 
                                                alt="Location Map"
                                                class="object-cover w-full h-full transition-transform duration-700 group-hover/map:scale-110"
                                            />
                                            <div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover/map:opacity-100 transition-opacity"></div>
                                        </div>
                                    </div>
                                    
                                    <ReviewSummary 
                                        googleRating={event.googleRating} 
                                        tripadvisorRating={event.tripadvisorRating} 
                                        label="Community Interest"
                                    />

                                    <!-- Info Items -->
                                    <div class="space-y-8">
                                        <SectionHeader label="Practical Details" />

                                        <div class="space-y-6">
                                            <PracticalInfoItem label="Time of Day" value={event.timeOfDay}>
                                                <Clock slot="icon" className="w-5 h-5 text-primary" />
                                            </PracticalInfoItem>

                                            <PracticalInfoItem label="Location" value={event.location}>
                                                <MapPin slot="icon" className="w-5 h-5 text-primary" />
                                            </PracticalInfoItem>
                                            
                                            <PracticalInfoItem label="Notes" value={event.practicalInfo}>
                                                <Info slot="icon" className="w-5 h-5 text-primary" />
                                            </PracticalInfoItem>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </article>
                </div>
            ))}
        </div>
    </section>

    <ClosingNote title="The Power of Chance">
        <Waves slot="background" className="w-full h-full scale-150" />
        <p>
            In the end, the most powerful moments in Riomaggiore are often the ones you didn't plan for. 
        </p>
        <p>
            It is the sound of a distant bell that leads you to a small chapel, or the sight of a monorail carrying a crate of grapes that reminds you of the season. To encounter an event by coincidence is to feel the village's rhythm in its most honest form.
        </p>
        <p>
            Don't chase the calendar. Let the village reveal itself to you in its own time. The most memorable moments happen slightly off schedule.
        </p>
        <div slot="actions" class="flex flex-wrap justify-center gap-6">
            <a href="/village" class="px-8 py-4 rounded-full bg-primary text-white font-bold text-sm uppercase tracking-widest hover:bg-primary/90 transition-colors">
                Explore the Village
            </a>
            <a href="/accommodations" class="px-8 py-4 rounded-full bg-white/10 backdrop-blur-sm text-white font-bold text-sm uppercase tracking-widest hover:bg-white/20 transition-colors">
                Where to Rest
            </a>
        </div>
    </ClosingNote>

    <Footer />
</Layout>

<style>
    html {
        scroll-behavior: smooth;
    }

    .font-serif {
        letter-spacing: -0.02em;
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    article {
        animation: fadeInUp 0.8s ease-out;
        animation-fill-mode: both;
    }
</style>
